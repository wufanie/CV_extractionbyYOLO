# cv_extractbyYOLO

#### 介绍
{**来自于机器视觉与图像测量的上机作业，目的是对图像中的直线和圆以及出现的数字和字母进行识别并检测，最后输出各轮廓的位置参数于.xls文件，并保存添加相应标注处理后的图像}

#### 软件处理流程及相关算法
### 直线和圆部分
一、预处理
原图像如图1.1所示，从图中可以看出原图像为灰度图像，且具有一定噪声，首先对原图进行滤波，由于最终需要提取到各直线和圆的较为准确的坐标，因此滤波应选择既能保证滤波效果又可以减小滤波过程中对图像的模糊的函数，这里选用非局部平均去噪。由于从图中可以看出直线和圆的轮廓较为清晰，因此可以直接使用传统图像处理的方法进行直线和圆的提取。
二、提取方法
	从图像中提取直线和圆通常可以利用设定阈值进行二值化后阈值提取的方法，但是由于本图像具有较强的一般性，即直线和圆的灰度分布范围较广。因此依据单一阈值二值化后的图像信息会有较大损失，利用二值化后阈值提取的方法不可靠。这里选择另一种直线和圆的提取方法，即先对图像进行边缘检测后再对图像使用霍夫变换提取直线和圆。
三、边缘检测
对图像进行边缘检测时使用Canny算子，根据设置低阈值和高阈值为50和150，设置算子的尺寸为3*3，利用Canny算子边缘检测后的效果。
 
四、直线和圆提取
在得到边缘检测的结果后，分别利用霍夫直线变换和霍夫圆变换对图1.2完成直线和圆所有位置参数的提取，提取结果如图1.3所示。
 
### 数字和字母部分
一、模型选择
从图1.1可以看出，原图的数字和字母仅部分清晰，同时大小，灰度各不相同，因此选用传统图像处理方案难以实现。这里我们选用YOLOv5s作为数字和字母的目标检测模型。
YOLO采用单个卷积神经网络来预测多个bounding boxes和类别概率。
二、数据集选择
目前主流的以数字和字母作为识别目标的数据集较多，例如ICDAR2003、MNIST、EMNIST、ICDAR2013等，由于本实验仅作为目标检测与定位，因此不需要多分类的数据集，同时为便于数据集的预处理，也尽量不使用byte类型的数据集诸如MNIST、EMNIST，这里选用ICDAR2013作为本次模型训练与验证的数据集，其中共包含229份大小为640*480的样本图片。
三、模型训练及验证
模型训练时不加载预训练模型，并设置归一化的图像块尺寸为64。利用Adam作为优化器并设置学习率为0.001，设置权重衰减系数为0.0005。设置总共的训练轮数为500次。
 

四、数字和字母检测
利用训练500轮后的网络权重参数进行测试，在测试时设置检测置信度为0.4时网络具有良好的检测准确性，设置检测交并比为0.25。
 





